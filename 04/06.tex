\subsection{%
  Операторы и аннигиляторы.%
}

\begin{definition}
  Оператор это метафункиция, которая продуцирует новую функцию.
\end{definition}

Свойства операторов:

\begin{itemize}
  \item Сумма \((f + g)(n) := f(n) + g(n)\)
  \item Растяжение \((\lambda f)(n) := \lambda f(n)\)
  \item Сдвиг \((E f)(n) = f(n + 1)\)
  \item \(k\)-сдвиг \(E^{k} f(n) = f(n + k)\)
  \item Композиция \((X \pm Y)f = Xf \pm Yf\), \(XY(f) = X(Yf) = Y(Xf)\)
  \item Дистрибутивность \(X(f + g) = Xf + Xg\)
\end{itemize}

Операторы можно рассматривать как полиномы относительно \(E\)

\begin{definition}
  Аннигилятор это оператор, который при применении к функции \(f\) превращает её
  в константный ноль.
\end{definition}

Каждый аннигилятор аннигилирует какой-то класс функций и ничего больше. Для
каждой \textit{хорошей} (полином, экспонента) функции можно найти
\textbf{уникальный} аннигилятор.

Свойства аннигиляторов:
\begin{itemize}
  \item Если \(X\) аннигилирует \(f\), то \(X\) также аннигилирует \(Ef\).
  \item Если \(X\) аннигилирует \(f\) и \(Y\) аннигилирует \(g\), то \(XY\)
  аннигилирует \(f \pm g\).
\end{itemize}

\begin{table}[H]
  \centering

  \renewcommand{\arraystretch}{1.5}
  \begin{tabular}{c|c|c}
    Аннигилятор & Класс функций & Примечание \\
    \hline
    \(E - 1\) & \(c_{1}\) & \\
    \(E - a\) & \(c_{1} a^{n}\) & \\
    \((E - a)(E - b)\) & \(c_{1} a^{n} + c_{2} b^{n}\) & \(a \neq b\) \\
    \((E - 1)^2\) & \(c_{1} n + c_{2}\) & \\
    \((E - a)^{d + 1}\) & \(a^{n} \sum_{i = 0}^{d} c_{i} n^{i}\) &
      Полином степени \(d\), умноженный на экспоненту
  \end{tabular}\caption*{Таблица аннигиляторов}
\end{table}

С помощью аннигиляторов можно решать рекуррентные соотношения

\underline{Пример}:
\begin{enumerate}
  \item Пусть требуется найти общую формулу для следующего рекуррентного
  соотношения
  
  \begin{align*}
    R_{n} = 3 R_{n - 2} - 2R_{n - 3} + 2^{n} + 1
  \end{align*}

  \item Перепишем, прибавив \(3\) к каждому индексу \(n\)
  
  \begin{align*}
    R_{n + 3} = 3 R_{n + 1} - 2R_{n} + 2^{n + 3} + 1
  \end{align*}

  \item Переведем полученное равенство в операторную форму, для этого заменим
  \(R_{n + i}\) на \(E^{i}\)

  \begin{align*}
    (E^3 - 3E + 2) R = 2^{n + 3} + 1
  \end{align*}

  \item Таким образом \(E^3 - 3E + 2\) аннигилирует левую часть, а
  \((E - 2)(E - 1)\)~--- правую (для того, чтобы это понять, смотрим в табличку
  и пользуется свойствами аннигиляторов).

  \item Разложим полученную композицию аннигиляторов на множители
  
  \begin{align*}
    (E^3 - 3E + 2)(E - 2)(E - 1) \\
    (E - 2)(E + 2)(E - 1)^{3}
  \end{align*}

  \item Для каждого из полученных аннигиляторов запишем общее решение
  
  \begin{align*}
    (E - 2) \longrightarrow c_{1} 2^{n} \\
    (E + 2) \longrightarrow c_{2} (-2)^{n} \\
    (E - 1)^3 \longrightarrow c_{3} n^{2} + c_{4} n + c_{5}
  \end{align*}

  \item Общим решением исходного рекуррентного соотношения будет композиция
  общих решений для каждого из аннигиляторов:

  \begin{align*}
    c_{1} 2^{n} + c_{2} (-2)^{n} + c_{3} n^{2} + c_{4} n + c_{5}
  \end{align*}
\end{enumerate}
